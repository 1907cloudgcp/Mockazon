steps:
- name: 'gcr.io/cloud-builders/docker'
  args:
  - 'build'
  - '-f'
  - 'uat.dockerfile'
  - '--build-arg' 
  - '${JDBC_PASSWORD%?}'
  - '-t'
  - 'uatimage:maven-env'
  - '.'
  env: ['JDBC_PASSWORD=${PASSWORD%?}']
  secretEnv: ['PASSWORD']
- name: "gcr.io/cloud-builders/gcloud"
  args: ["app", "deploy", "uat/app.yaml"]
secrets:
- kmsKeyName: projects/mockazon/locations/us-central1/keyRings/mockazon_ring/cryptoKeys/sql_pass
  secretEnv:
    PASSWORD: CiQAhVODvPtbGti6rQOhfUIQYFI1P0V6CaAevgnbpgSH2SEXnscSMgAGs0POy8+bDut9eo2h5uRWqFGqG3XseACt8Po9jYv+2eeY1gkAVhFlyKlN50/41Fok
# timeout: "600s"

